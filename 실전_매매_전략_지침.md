# 실전 매매 전략 지침 (실전_매매_전략_지침.md)

본 문서는 '청안(Cheongan) 분석 시스템'의 알고리즘이 따르는 실전 매매 전략과 원칙을 정의합니다. 모든 자동 매매 및 신호 송출 로직은 이 지침을 따릅니다. 본 지침은 관리자의 허락 없이 변경할 수 없습니다.

## 1. 시장 상황별 대응 (Market Regime Analysis)
가장 먼저 전체 시장의 추세(Regime)를 파악하고 포지션을 결정합니다.
판단 기준은 **UPRO(S&P500 3배 레버리지)**의 일일 등락률(Rate)을 기준으로 합니다.

*   **상승장 (Bull Market)**: UPRO +1.5% 이상
*   **하락장 (Bear Market)**: UPRO -1.5% 이하
*   **보합장 (Sideways)**: UPRO -1.5% ~ +1.5% 이내

## 2. 진입 전략 (Entry Strategy: SOXL/SOXS Triple Filter)
단순한 지표 하나로 진입하지 않고, 3단계 필터를 모두 통과해야 진입 신호(BUY)를 확정합니다.

**Active_Trader 알고리즘 (SOXL/SOXS 전용)**
*   **Filter 1 (추세 전환)**: 30분봉에서 단기(10선) 이평선이 장기(30선) 이평선을 상향 돌파 (**30m Golden Cross**).
*   **Filter 2 (강도 확인)**: 전일종가 대비 **2% 이상** 변동.
    *   **SOXL (상승)**: 전일종가 대비 +2% 이상 상승 (`P_curr >= P_prev_close * 1.02`)
    *   **SOXS (하락)**: 전일종가 대비 -2% 이상 하락 (`P_curr <= P_prev_close * 0.98`)
*   **Filter 3 (최종 진입 타이밍)**: 위 1, 2번 조건이 충족된 상태에서 **5분봉 10선이 30선을 골든크로스** 할 때 최종 진입 (100% 매수).

## 3. 익절 및 리스크 관리 (Exit & Risk Management)
매수 후 관리 전략은 30분봉 골든크로스 시점의 종가(`P_base`)를 기준으로 단계별 대응합니다.

### 수익 구간 관리
*   **Stage 1 (상승률 2% ~ 7%)**: 100% 포지션 유지 (추세 추종).
*   **Stage 2 (상승률 7% ~ 10%)**: 추세 지속 보유.
*   **Stage 3 (상승률 10% 이상)**: 보유 수량의 **50% 기계적 익절** (이익 실현).

### 긴급 및 손절 대응
*   **긴급 익절**: 상승률 단계와 관계없이 **5분봉 데드크로스(10/30)** 발생 시 현재 수량의 **50% 즉시 익절**.
*   **부분 매도**: 5분봉 데드크로스 발생 **AND** 전 고점 대비 **-2% 이상 하락** 시 → 50% 매도 신호.
*   **전량 매도 (Stop Loss)**:
    1.  현재가가 매수 단가보다 같거나 낮아질 경우 (`P_curr <= Avg_Price`) → **전량 매도**.
    2.  **30분봉 데드크로스(10/30)** 발생 시 → 남은 물량 **전량 매도** 후 거래 종료.

## 4. 시장 감시 기반 청산 (UPRO Monitoring)
UPRO 종목을 매매하지 않더라도, 시장 지표로 활용하여 보유 종목(SOXL/SOXS)의 청산 신호로 사용합니다.

*   **주의 단계**: UPRO 30분봉 **데드크로스** 발생 시
    *   명령: "주의! 보유 주식 50% 매도" 신호 출력.
*   **위험 단계**: UPRO가 당일 고점 대비 **-10%** 하락 시
    *   명령: "위험! 보유 주식 100% 매도" 신호 출력.

## 5. 알고리즘 적용 및 신호 전송 (Algorithm Implementation)
*   **신호 발생**: 진입 및 청산 전략에 따른 조건 만족 시 즉시 신호 생성.
*   **SMS 전송 제한 (Rate Limit)**:
    *   동일 종목에 대해 **30분 이내에 중복 알림을 발송하지 않는다.**
    *   발송 이력은 데이터베이스(DB)에서 관리하여 철저히 통제한다.

## 6. UI 및 표시 지침 (UI & Display Standards)
사용자 인터페이스(대시보드)는 다음 원칙을 준수하여 시각적 명확성을 보장합니다.

*   **시간 표시 (Time Display)**:
    *   모든 중요 신호 발생 시각은 미국(NY) 시간과 한국(KR) 시간의 **이중 표기(Dual Time)**를 원칙으로 합니다.
    *   포맷: `yyyy.MM.dd HH:mm` (예: `2026.01.01 11:45`)
    *   국가 표시: 🇺🇸 (NY) / 🇰🇷 (KR) 국기 아이콘 및 줄바꿈을 활용하여 가독성을 높입니다.

*   **상태 표시 (Indicator States)**:
    *   **조건 대기 (Waiting)**: 조건이 충족되지 않은 상태에서는 인디케이터를 어둡게(Dark/Grey) 처리하여 '꺼짐(Off)' 상태임을 명확히 합니다. 희미한 유채색 사용을 지양합니다.
    *   **조건 충족 (Active)**: 조건 달성 시에만 지정된 색상(Bull: Red, Bear: Blue)과 애니메이션(Pulse)을 활성화합니다.

