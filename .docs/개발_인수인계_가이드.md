# ğŸ“¦ Stock Trading System - ê°œë°œ ì¸ìˆ˜ì¸ê³„ ê°€ì´ë“œ

> **ëª©ì **: ë‹¤ë¥¸ AI ëª¨ë¸ ë˜ëŠ” ê°œë°œìê°€ ì´ í”„ë¡œì íŠ¸ë¥¼ ì¦‰ì‹œ ì´í•´í•˜ê³  ì‘ì—…í•  ìˆ˜ ìˆë„ë¡ ëª¨ë“  ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

**ì‘ì„±ì¼**: 2026-01-04  
**í˜„ì¬ ë²„ì „**: v3.0.3  
**í”„ë¡œì íŠ¸ëª…**: Stock Trading System (ì²­ì•ˆ ì‹œìŠ¤í…œ)  
**ì£¼ìš” ê°œë°œì**: blueeye

---

## ğŸ“‹ ëª©ì°¨
1. [í”„ë¡œì íŠ¸ ê°œìš”](#í”„ë¡œì íŠ¸-ê°œìš”)
2. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
3. [ê¸°ìˆ  ìŠ¤íƒ](#ê¸°ìˆ -ìŠ¤íƒ)
4. [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](#ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ)
5. [API ì—”ë“œí¬ì¸íŠ¸](#api-ì—”ë“œí¬ì¸íŠ¸)
6. [í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§](#í•µì‹¬-ë¹„ì¦ˆë‹ˆìŠ¤-ë¡œì§)
7. [íŒŒì¼ êµ¬ì¡°](#íŒŒì¼-êµ¬ì¡°)
8. [í™˜ê²½ ì„¤ì •](#í™˜ê²½-ì„¤ì •)
9. [ë°°í¬ ë°©ë²•](#ë°°í¬-ë°©ë²•)
10. [MCP ì„œë²„ ì„¤ì •](#mcp-ì„œë²„-ì„¤ì •)
11. [ê°œë°œ ì›Œí¬í”Œë¡œìš°](#ê°œë°œ-ì›Œí¬í”Œë¡œìš°)
12. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)

---

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”

### ì‹œìŠ¤í…œ ëª©ì 
ë¯¸êµ­ ì£¼ì‹ ë ˆë²„ë¦¬ì§€ ETF(SOXL, SOXS, UPRO) ìë™ ë§¤ë§¤ ì‹ í˜¸ ê°ì§€ ë° í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬ ì‹œìŠ¤í…œ

### ì£¼ìš” ê¸°ëŠ¥
1. **MASTER CONTROL TOWER**: ì‹¤ì‹œê°„ ë§¤ë§¤ ì‹ í˜¸ ê°ì§€ ë° í‘œì‹œ
   - 3ë‹¨ê³„ í•„í„° ì‹œìŠ¤í…œ (30ë¶„ë´‰ ì¶”ì„¸, ë°•ìŠ¤ê¶Œ ëŒíŒŒ, 5ë¶„ë´‰ ì§„ì…)
   - 3ë‹¨ê³„ ê²½ë³´ ì‹œìŠ¤í…œ (Yellow, Orange, Red)
   - ì‹¤ì‹œê°„ ì°¨íŠ¸ ë° ê°€ê²© ì •ë³´

2. **Signal Detection**: ê³¼ê±° ì‹ í˜¸ ê¸°ë¡ ì¡°íšŒ ë° ë¶„ì„
3. **Portfolio Management**: ë³´ìœ  ì¢…ëª© ë° ë§¤ë§¤ ì¼ì§€ ê´€ë¦¬
4. **Stock Management**: ê´€ì‹¬ ì¢…ëª© ë“±ë¡ ë° ê´€ë¦¬

### ì ‘ê·¼ URL
- **ë¡œì»¬**: http://localhost:5000
- **ë°°í¬**: http://money.mysmartgate.kr

---

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ì „ì²´ êµ¬ì¡°
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚  React + Vite
â”‚   (Port 5000)   â”‚  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚  Nginx   â”‚  Reverse Proxy
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend       â”‚  FastAPI + Uvicorn
â”‚   (Port 9100)   â”‚  
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   MariaDB    â”‚  114.108.180.228:3306
    â”‚  (mywork_01) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
/home/blue/blue/my_project/money/
â”œâ”€â”€ frontend/               # React í”„ë¡ íŠ¸ì—”ë“œ
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.jsx        # ë©”ì¸ ì•± ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ DashboardPage.jsx  # MASTER CONTROL TOWER
â”‚   â”‚   â”œâ”€â”€ SignalPage.jsx     # ì‹ í˜¸ ê°ì§€ í˜ì´ì§€
â”‚   â”‚   â”œâ”€â”€ JournalPage.jsx    # ë§¤ë§¤ ì¼ì§€
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ dist/              # ë¹Œë“œ ê²°ê³¼ë¬¼
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ backend/               # FastAPI ë°±ì—”ë“œ
â”‚   â”œâ”€â”€ main.py           # FastAPI ì•± ì§„ì…ì 
â”‚   â”œâ”€â”€ db.py             # ë°ì´í„°ë² ì´ìŠ¤ ë¡œì§
â”‚   â”œâ”€â”€ kis_api.py        # í•œêµ­íˆ¬ìì¦ê¶Œ API
â”‚   â”œâ”€â”€ venv/             # Python ê°€ìƒí™˜ê²½
â”‚   â””â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ .docs/                # í”„ë¡œì íŠ¸ ë¬¸ì„œ
â”‚   â”œâ”€â”€ ğŸš€_ì‹œì‘í•˜ê¸°_í•„ë….md
â”‚   â”œâ”€â”€ í™˜ê²½ì„¤ì •/
â”‚   â”œâ”€â”€ ê°œë°œì§€ì¹¨/
â”‚   â””â”€â”€ MCP/
â”‚
â”œâ”€â”€ deploy.sh             # ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ CHANGELOG.md          # ë³€ê²½ ì´ë ¥
```

---

## ğŸ’» ê¸°ìˆ  ìŠ¤íƒ

### Frontend
- **í”„ë ˆì„ì›Œí¬**: React 18.3.1
- **ë¹Œë“œ ë„êµ¬**: Vite 5.4.21
- **ë¼ìš°íŒ…**: React Router DOM 7.11.0
- **HTTP í´ë¼ì´ì–¸íŠ¸**: Axios 1.7.9
- **ìŠ¤íƒ€ì¼ë§**: Vanilla CSS (Inline Styles)

### Backend
- **í”„ë ˆì„ì›Œí¬**: FastAPI 0.128.0
- **ASGI ì„œë²„**: Uvicorn 0.40.0
- **ë°ì´í„°**: Pandas 2.3.3, NumPy 2.4.0
- **ë°ì´í„°ë² ì´ìŠ¤**: PyMySQL 1.1.2, DBUtils 3.1.2
- **ìŠ¤ì¼€ì¤„ëŸ¬**: APScheduler 3.11.2
- **ì£¼ì‹ ë°ì´í„°**: yfinance 1.0
- **í•œêµ­íˆ¬ìì¦ê¶Œ API**: ì§ì ‘ êµ¬í˜„ (kis_api.py)

### Database
- **DBMS**: MariaDB 10.x
- **Connection**: DBUtils Pool (ìµœëŒ€ 10ê°œ ì—°ê²°)
- **Character Set**: utf8mb4

### Infrastructure
- **OS**: Ubuntu Server 22.04
- **Web Server**: Nginx
- **Process Manager**: systemd
- **Python**: 3.12
- **Node.js**: v18.20.8

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### ì—°ê²° ì •ë³´
```python
DB_CONFIG = {
    "host": "114.108.180.228",
    "port": 3306,
    "user": "blueeye",
    "password": "blueeye0037!",
    "database": "mywork_01",
    "charset": "utf8mb4"
}
```

### í…Œì´ë¸” êµ¬ì¡°

#### 1. signal_history (ì‹ í˜¸ ê¸°ë¡)
```sql
CREATE TABLE signal_history (
    id INT AUTO_INCREMENT PRIMARY KEY,
    ticker VARCHAR(10) NOT NULL,           -- ì¢…ëª© ì½”ë“œ (SOXL, SOXS, UPRO)
    signal_type VARCHAR(10) NOT NULL,      -- BUY, SELL
    signal_time DATETIME NOT NULL,         -- ì‹ í˜¸ ë°œìƒ ì‹œê°„ (ì°¨íŠ¸ ì‹œê°„)
    price DECIMAL(10,2),                   -- ì‹ í˜¸ ë°œìƒ ì‹œ ê°€ê²©
    time_kst DATETIME,                     -- í•œêµ­ ì‹œê°„
    time_ny DATETIME,                      -- ë‰´ìš• ì‹œê°„
    signal_reason TEXT,                    -- ì‹ í˜¸ ë°œìƒ ì´ìœ 
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_ticker_time (ticker, signal_time),
    INDEX idx_signal_type (signal_type)
);
```

#### 2. managed_stocks (ê´€ë¦¬ ì¢…ëª©)
```sql
CREATE TABLE managed_stocks (
    id INT AUTO_INCREMENT PRIMARY KEY,
    code VARCHAR(10) UNIQUE NOT NULL,      -- ì¢…ëª© ì½”ë“œ
    name VARCHAR(100) NOT NULL,            -- ì¢…ëª©ëª…
    exchange VARCHAR(20) DEFAULT 'US',     -- ê±°ë˜ì†Œ (US, KR)
    current_price DECIMAL(10,2),           -- í˜„ì¬ê°€
    is_manual_price BOOLEAN DEFAULT FALSE, -- ìˆ˜ë™ ì…ë ¥ ì—¬ë¶€
    price_updated_at DATETIME,             -- ê°€ê²© ì—…ë°ì´íŠ¸ ì‹œê°„
    is_active BOOLEAN DEFAULT TRUE,        -- í™œì„± ìƒíƒœ
    target_ratio DECIMAL(5,2),             -- ëª©í‘œ ë¹„ì¤‘ (%)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 3. journal_transactions (ê±°ë˜ ë‚´ì—­)
```sql
CREATE TABLE journal_transactions (
    id INT AUTO_INCREMENT PRIMARY KEY,
    ticker VARCHAR(10) NOT NULL,           -- ì¢…ëª© ì½”ë“œ
    trade_type VARCHAR(10) NOT NULL,       -- BUY, SELL
    qty INT NOT NULL,                      -- ìˆ˜ëŸ‰
    price DECIMAL(10,2) NOT NULL,          -- ê°€ê²©
    trade_date DATE NOT NULL,              -- ê±°ë˜ì¼
    memo TEXT,                             -- ë©”ëª¨
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_ticker (ticker),
    INDEX idx_trade_date (trade_date)
);
```

#### 4. total_capital (ì´ ìì‚°)
```sql
CREATE TABLE total_capital (
    id INT PRIMARY KEY DEFAULT 1,
    amount DECIMAL(15,2) NOT NULL,         -- ì´ ìì‚° (ì›í™”)
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 5. market_candles (ìº”ë“¤ ë°ì´í„° ìºì‹œ)
```sql
CREATE TABLE market_candles (
    id INT AUTO_INCREMENT PRIMARY KEY,
    ticker VARCHAR(10) NOT NULL,
    timeframe VARCHAR(10) NOT NULL,        -- 5m, 30m, 1d
    candle_time DATETIME NOT NULL,
    open_price DECIMAL(10,4),
    high_price DECIMAL(10,4),
    low_price DECIMAL(10,4),
    close_price DECIMAL(10,4),
    volume BIGINT,
    source VARCHAR(20),                    -- yfinance, KIS
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE KEY unique_candle (ticker, timeframe, candle_time),
    INDEX idx_ticker_timeframe (ticker, timeframe),
    INDEX idx_candle_time (candle_time)
);
```

#### 6. price_cache (ê°€ê²© ìºì‹œ)
```sql
CREATE TABLE price_cache (
    ticker VARCHAR(10) PRIMARY KEY,
    price DECIMAL(10,2),
    diff DECIMAL(10,2),
    rate DECIMAL(5,2),
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

#### 7. user_requests (ìš”ì²­ì‚¬í•­ ê¸°ë¡)
```sql
CREATE TABLE user_requests (
    id INT AUTO_INCREMENT PRIMARY KEY,
    request_text TEXT NOT NULL,            -- ì‚¬ìš©ì ìš”ì²­ ì›ë¬¸
    ai_interpretation TEXT,                -- AI í•´ì„
    implementation_details TEXT,           -- êµ¬í˜„ ìƒì„¸
    status VARCHAR(20) DEFAULT 'pending',  -- pending, completed
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    completed_at DATETIME
);
```

---

## ğŸ”Œ API ì—”ë“œí¬ì¸íŠ¸

### Base URL
- Local: `http://localhost:9100`
- Production: `http://money.mysmartgate.kr`

### ì—”ë“œí¬ì¸íŠ¸ ëª©ë¡

#### 1. MASTER CONTROL TOWER
```
GET /api/report
```
**ì‘ë‹µ ì˜ˆì‹œ**:
```json
{
  "market_regime": {
    "status": "ìƒìŠ¹ì¥",
    "details": {
      "soxl": {
        "ticker": "SOXL",
        "current_price": 25.50,
        "filters": {
          "filter1_30m": "âœ“ ê³¨ë“ í¬ë¡œìŠ¤",
          "filter2_breakout": "âœ“ +2.5% ëŒíŒŒ",
          "filter3_5m": "âœ“ ê³¨ë“ í¬ë¡œìŠ¤"
        },
        "all_met": true,
        "entry_price": 24.80,
        "alerts": []
      }
    }
  },
  "market": {
    "KRW": {"value": 1444.5}
  }
}
```

#### 2. ì‹ í˜¸ ê¸°ë¡
```
GET /api/signals?ticker=SOXL&limit=50
POST /api/signals
DELETE /api/signals/{id}
```

#### 3. ì¢…ëª© ê´€ë¦¬
```
GET /api/stocks
POST /api/stocks
  Body: {"code": "SOXL", "name": "Direxion Daily Semiconductor Bull 3X"}
DELETE /api/stocks/{code}
POST /api/stocks/update-prices
POST /api/stocks/{id}/price
  Body: {"price": 25.50}
```

#### 4. ë§¤ë§¤ ì¼ì§€
```
GET /api/transactions
POST /api/transactions
  Body: {"ticker": "SOXL", "qty": 100, "price": 25.00, "memo": "..."}
PUT /api/transactions/{id}
DELETE /api/transactions/{id}
```

#### 5. ì´ ìì‚°
```
GET /api/capital
POST /api/capital
  Body: {"amount": 14445000}
```

#### 6. ìš”ì²­ì‚¬í•­
```
GET /api/requests
POST /api/requests
  Body: {"request_text": "...", "ai_interpretation": "...", ...}
```

---

## ğŸ§  í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

### SOXL/SOXS ë§¤ë§¤ ì „ëµ (Triple Filter System)

#### Filter 1: 30ë¶„ë´‰ ê¸°ì¤€ (ì¶”ì„¸ í™•ì •)
```python
# ê³¨ë“ í¬ë¡œìŠ¤: MA5 > MA20
# ë°ë“œí¬ë¡œìŠ¤: MA5 < MA20
ma5 = data['close'].rolling(5).mean()
ma20 = data['close'].rolling(20).mean()

if ma5.iloc[-1] > ma20.iloc[-1]:
    filter1 = "ê³¨ë“ í¬ë¡œìŠ¤"  # ìƒìŠ¹ ì¶”ì„¸
else:
    filter1 = "ë°ë“œí¬ë¡œìŠ¤"  # í•˜ë½ ì¶”ì„¸
```

#### Filter 2: ë°•ìŠ¤ê¶Œ ëŒíŒŒ ì¡°ê±´
```python
# ì „ì¼ ì¢…ê°€ ëŒ€ë¹„ +2% ì´ìƒ ìƒìŠ¹
yesterday_close = data_1d['close'].iloc[-2]
current_price = data['close'].iloc[-1]
change_pct = ((current_price - yesterday_close) / yesterday_close) * 100

if change_pct >= 2.0:
    filter2 = "âœ“ +{:.1f}% ëŒíŒŒ".format(change_pct)
else:
    filter2 = "ë³´í•© ({:+.1f}%)".format(change_pct)
```

#### Filter 3: 5ë¶„ë´‰ ê¸°ì¤€ (ì§„ì… ì‹ í˜¸)
```python
# 5ë¶„ë´‰ ê³¨ë“ í¬ë¡œìŠ¤
ma5_5m = data_5m['close'].rolling(5).mean()
ma20_5m = data_5m['close'].rolling(20).mean()

if ma5_5m.iloc[-1] > ma20_5m.iloc[-1]:
    filter3 = "âœ“ ê³¨ë“ í¬ë¡œìŠ¤"  # ì§„ì… íƒ€ì´ë°
else:
    filter3 = "ë°ë“œí¬ë¡œìŠ¤"
```

#### ì§„ì… ì¡°ê±´
```python
all_met = (
    "ê³¨ë“ í¬ë¡œìŠ¤" in filter1 and
    "âœ“" in filter2 and
    "âœ“" in filter3
)

if all_met and not already_entered:
    # ë§¤ìˆ˜ ì‹ í˜¸ ë°œìƒ
    save_signal("SOXL", "BUY", current_price)
```

### 3ë‹¨ê³„ ê²½ë³´ ì‹œìŠ¤í…œ

#### Yellow Alert (ğŸŸ¡)
- **ì¡°ê±´**: 5ë¶„ë´‰ ë°ë“œí¬ë¡œìŠ¤ ë°œìƒ
- **ì•¡ì…˜**: ë³´ìœ ëŸ‰ì˜ 30% ë§¤ë„

#### Orange Alert (ğŸŸ )
- **ì¡°ê±´**: í˜„ì¬ê°€ê°€ ì§„ì…ê°€ í•˜íšŒ
- **ì•¡ì…˜**: ë‚¨ì€ ë³´ìœ ëŸ‰ì˜ 30% ë§¤ë„

#### Red Alert (ğŸ”´)
- **ì¡°ê±´**: 30ë¶„ë´‰ ë°ë“œí¬ë¡œìŠ¤ ë°œìƒ
- **ì•¡ì…˜**: ë‚¨ì€ ì „ëŸ‰ ë§¤ë„ + ìƒíƒœ ì´ˆê¸°í™”

### UPRO ëª¨ë‹ˆí„°ë§
- **ëª©ì **: ìƒìŠ¹ì¥/í•˜ë½ì¥ íŒë‹¨
- **ë¡œì§**: S&P 500 3ë°° ë ˆë²„ë¦¬ì§€ ETF ì¶”ì„¸ í™•ì¸
- **ìš©ë„**: SOXL/SOXS ì „í™˜ íŒë‹¨ ê¸°ì¤€

---

## ğŸ“‚ íŒŒì¼ êµ¬ì¡°

### ì£¼ìš” Frontend íŒŒì¼

#### `frontend/src/App.jsx`
```javascript
// ë¼ìš°íŒ… ì„¤ì •
<Routes>
  <Route path="/" element={<DashboardPage />} />
  <Route path="/signals" element={<SignalPage />} />
  <Route path="/journal" element={<JournalPage />} />
</Routes>
```

#### `frontend/src/DashboardPage.jsx`
- MASTER CONTROL TOWER êµ¬í˜„
- ì‹¤ì‹œê°„ ë°ì´í„° í´ë§ (3ì´ˆë§ˆë‹¤)
- 3ë‹¨ê³„ í•„í„° í‘œì‹œ
- ê²½ë³´ ì‹œìŠ¤í…œ í‘œì‹œ

#### `frontend/src/SignalPage.jsx`
- ì‹ í˜¸ ê¸°ë¡ ì¡°íšŒ
- ë‚ ì§œ í•„í„°ë§
- SMS ë°œì†¡ í…ŒìŠ¤íŠ¸

#### `frontend/src/JournalPage.jsx`
- í¬íŠ¸í´ë¦¬ì˜¤ ê´€ë¦¬
- ë³´ìœ  ì¢…ëª© í‘œì‹œ
- í‰ê°€ ì†ìµ ê³„ì‚°

### ì£¼ìš” Backend íŒŒì¼

#### `backend/main.py`
```python
# FastAPI ì•± ì„¤ì •
app = FastAPI()

# CORS ì„¤ì •
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_methods=["*"],
    allow_headers=["*"]
)

# ìŠ¤ì¼€ì¤„ëŸ¬ ì„¤ì •
scheduler = BackgroundScheduler()
scheduler.add_job(
    update_market_data,
    'interval',
    seconds=180  # 3ë¶„ë§ˆë‹¤
)
```

#### `backend/db.py`
- ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í’€ ê´€ë¦¬
- ì‹ í˜¸ ê°ì§€ ë¡œì§ êµ¬í˜„ (`check_triple_filter`)
- ë°ì´í„° ìˆ˜ì§‘ (`fetch_data`, `fetch_kis_data`)
- DB CRUD ì‘ì—…

#### `backend/kis_api.py`
- í•œêµ­íˆ¬ìì¦ê¶Œ API ì—°ë™
- OAuth í† í° ê´€ë¦¬
- ì‹¤ì‹œê°„/ê³¼ê±° ë°ì´í„° ì¡°íšŒ

---

## âš™ï¸ í™˜ê²½ ì„¤ì •

### í™˜ê²½ ë³€ìˆ˜ (.bashrc)
```bash
# Context7 MCP API í‚¤
export CONTEXT7_API_KEY=ctx7sk-2f719444-158c-4294-aeff-548e188dbe3c
export MCP_CONFIG_PATH=~/.config/mcp/config.json

# Brave Search MCP API í‚¤
export BRAVE_API_KEY=BSAuMtSaYEFlWlGFHDg4ee1ZN-GLLOV

# í”„ë¡œì íŠ¸ alias
alias web-run100='/home/blue/blue/my_project/money/deploy.sh'
```

### ë¹„ë°€ë²ˆí˜¸ ë° ì¸ì¦ ì •ë³´
```
sudo ë¹„ë°€ë²ˆí˜¸: blueeye0037!
DB ë¹„ë°€ë²ˆí˜¸: blueeye0037!
```

### Python ê°€ìƒí™˜ê²½
```bash
cd /home/blue/blue/my_project/money/backend
source venv/bin/activate
```

### í•„ìˆ˜ íŒ¨í‚¤ì§€ (requirements.txt)
```
fastapi==0.128.0
uvicorn==0.40.0
yfinance==1.0
pandas==2.3.3
pytz==2025.2
lxml==6.0.2
numpy==2.4.0
pymysql==1.1.2
apscheduler==3.11.2
requests==2.32.5
cryptography==46.0.3
DBUtils==3.1.2
```

---

## ğŸš€ ë°°í¬ ë°©ë²•

### ìë™ ë°°í¬ (ê¶Œì¥)
```bash
cd /home/blue/blue/my_project/money
./deploy.sh
```

**deploy.sh ë‚´ìš©**:
```bash
#!/bin/bash
set -e

# 1. ë°±ì—”ë“œ ì—…ë°ì´íŠ¸
cd backend
source venv/bin/activate
pip install -r requirements.txt
echo "blueeye0037!" | sudo -S systemctl restart cheongan-backend

# 2. í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ
cd ../frontend
npm install
npm run build

echo "âœ… ë°°í¬ ì™„ë£Œ!"
```

### ìˆ˜ë™ ë°°í¬

#### Frontend ë¹Œë“œ
```bash
cd /home/blue/blue/my_project/money/frontend
npm run build
```

#### Backend ì¬ì‹œì‘
```bash
echo "blueeye0037!" | sudo -S systemctl restart cheongan-backend
```

### Systemd ì„œë¹„ìŠ¤ ì„¤ì •

#### cheongan-backend.service
```ini
[Unit]
Description=Cheongan Backend Service
After=network.target

[Service]
User=blue
Group=www-data
WorkingDirectory=/home/blue/blue/my_project/money/backend
Environment="PATH=/home/blue/blue/my_project/money/backend/venv/bin"
ExecStart=/home/blue/blue/my_project/money/backend/venv/bin/gunicorn -k uvicorn.workers.UvicornWorker main:app --bind 0.0.0.0:9100 --workers 2

[Install]
WantedBy=multi-user.target
```

### Nginx ì„¤ì •
```nginx
server {
    server_name money.mysmartgate.kr;

    location / {
        root /home/blue/blue/my_project/money/frontend/dist;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    location /api {
        proxy_pass http://127.0.0.1:9100;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## ğŸ¤– MCP ì„œë²„ ì„¤ì •

### ë“±ë¡ëœ MCP ì„œë²„ (8ê°œ)

#### 1. Context7 (ì½”ë“œ ê²€ìƒ‰)
```json
{
  "command": "npx",
  "args": ["-y", "@upstash/context7-mcp@latest", "--api-key", "ctx7sk-2f719444-158c-4294-aeff-548e188dbe3c"],
  "env": {"CONTEXT7_API_KEY": "ctx7sk-2f719444-158c-4294-aeff-548e188dbe3c"}
}
```

#### 2. Sequential Thinking (ë‹¨ê³„ë³„ ë¶„ì„)
```json
{
  "command": "npx",
  "args": ["-y", "@modelcontextprotocol/server-sequential-thinking"]
}
```

#### 3. Filesystem (íŒŒì¼ ì‘ì—…)
```json
{
  "command": "npx",
  "args": ["-y", "@modelcontextprotocol/server-filesystem", "/home/blue/blue/my_project", "/home/blue"]
}
```

#### 4. MySQL (ë°ì´í„°ë² ì´ìŠ¤)
```json
{
  "command": "npx",
  "args": ["-y", "@benborla29/mcp-server-mysql"],
  "env": {
    "MYSQL_HOST": "114.108.180.228",
    "MYSQL_PORT": "3306",
    "MYSQL_USER": "blueeye",
    "MYSQL_PASSWORD": "blueeye0037!",
    "MYSQL_DATABASE": "mywork_01"
  }
}
```

#### 5. Shell (ëª…ë ¹ ì‹¤í–‰)
```json
{
  "command": "npx",
  "args": ["-y", "@modelcontextprotocol/server-shell"]
}
```

#### 6. Memory (ì»¨í…ìŠ¤íŠ¸ ì €ì¥)
```json
{
  "command": "npx",
  "args": ["-y", "@modelcontextprotocol/server-memory"]
}
```

#### 7. Fetch (HTTP ìš”ì²­)
```json
{
  "command": "npx",
  "args": ["-y", "@modelcontextprotocol/server-fetch"]
}
```

#### 8. Brave Search (ì›¹ ê²€ìƒ‰)
```json
{
  "command": "npx",
  "args": ["-y", "@modelcontextprotocol/server-brave-search"],
  "env": {"BRAVE_API_KEY": "BSAuMtSaYEFlWlGFHDg4ee1ZN-GLLOV"}
}
```

### MCP ì„¤ì • íŒŒì¼ ìœ„ì¹˜
- Antigravity: `~/.gemini/antigravity/mcp_config.json`
- ì „ì—­: `~/.config/mcp/config.json`
- Cursor: `~/.cursor/mcp.json`

---

## ğŸ”„ ê°œë°œ ì›Œí¬í”Œë¡œìš°

### í•„ìˆ˜ ì‘ì—… ì ˆì°¨ (7ë‹¨ê³„)

#### 1. CHANGELOG.md ì—…ë°ì´íŠ¸
```markdown
## [Ver 3.0.X] - 2026-01-04

### ì¶”ê°€ (Added)
- ê¸°ëŠ¥ ì„¤ëª…

### ìˆ˜ì • (Fixed)
- ë²„ê·¸ ìˆ˜ì • ë‚´ì—­

### ë³€ê²½ (Changed)
- ë³€ê²½ì‚¬í•­
```

#### 2. Frontend ë¹Œë“œ
```bash
cd frontend
npm run build
```

#### 3. Git ì»¤ë°‹ & í‘¸ì‹œ
```bash
git add -A
git commit -m "[v3.0.X] ì‘ì—… ë‚´ìš©"
git push origin main
```

#### 4. ì›¹ ë°°í¬
```bash
./deploy.sh
```

#### 5. Footer ë²„ì „ ì—…ë°ì´íŠ¸ (í•„ìš”ì‹œ)
```javascript
// frontend/src/App.jsx
<p>Â© 2026 Stock Trading System. Ver 3.0.X (Build: 2026-01-04 20:00)</p>
```

#### 6. ìš”ì²­ì‚¬í•­ DB ë“±ë¡
```bash
curl -X POST http://localhost:9100/api/requests \
  -H "Content-Type: application/json" \
  -d '{
    "request_text": "ì‚¬ìš©ì ìš”ì²­ ì›ë¬¸",
    "ai_interpretation": "ìš”ì•½",
    "implementation_details": "êµ¬í˜„ ë‚´ì—­",
    "status": "completed"
  }'
```

#### 7. ê²€ì¦
- ì›¹ì‚¬ì´íŠ¸ ì ‘ì† í™•ì¸
- ì£¼ìš” ê¸°ëŠ¥ ë™ì‘ í™•ì¸
- ë²„ì „ ì¼ì¹˜ í™•ì¸

### í•µì‹¬ ì›ì¹™
1. **í•œêµ­ì–´ ì‚¬ìš©**: ëª¨ë“  ì„¤ëª…, ì£¼ì„, ë¬¸ì„œëŠ” í•œêµ­ì–´
2. **MCP í™œìš©**: ëª¨ë“  ì‘ì—…ì— MCP ì„œë²„ ìë™ í™œìš©
3. **ìë™ ë°°í¬**: ì‘ì—… ì™„ë£Œ í›„ 7ë‹¨ê³„ í•„ìˆ˜ ì‹¤í–‰

---

## ğŸ› íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### Frontend ë¹Œë“œ ì‹¤íŒ¨
```bash
cd frontend
rm -rf node_modules package-lock.json
npm install
npm run build
```

### Backend ì„œë¹„ìŠ¤ ì˜¤ë¥˜
```bash
# ìƒíƒœ í™•ì¸
sudo systemctl status cheongan-backend

# ë¡œê·¸ í™•ì¸
journalctl -u cheongan-backend -n 50

# ì¬ì‹œì‘
echo "blueeye0037!" | sudo -S systemctl restart cheongan-backend
```

### ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨
```bash
# ì—°ê²° í…ŒìŠ¤íŠ¸
mysql -h 114.108.180.228 -P 3306 -u blueeye -p mywork_01
# ë¹„ë°€ë²ˆí˜¸: blueeye0037!

# DB í’€ í™•ì¸
# backend/db.pyì˜ POOL_SIZE í™•ì¸
```

### yfinance Rate Limit
- **ì¦ìƒ**: Too Many Requests (429)
- **í•´ê²°**: DB ìºì‹œ ì‚¬ìš© + KIS APIë¡œ ì „í™˜
- **ìœ„ì¹˜**: `backend/db.py - fetch_data_with_fallback()`

### MCP ì„œë²„ ì˜¤ë¥˜
```bash
# JSON ìœ íš¨ì„± ê²€ì‚¬
python3 -m json.tool ~/.gemini/antigravity/mcp_config.json

# Node.js ë²„ì „ í™•ì¸ (18 ì´ìƒ í•„ìš”)
node --version
```

---

## ğŸ“Š ì£¼ìš” ì„±ëŠ¥ ì§€í‘œ

### Backend
- **ì‘ë‹µ ì‹œê°„**: í‰ê·  < 500ms
- **ë°ì´í„° ì—…ë°ì´íŠ¸**: 3ë¶„ë§ˆë‹¤
- **DB ì—°ê²° í’€**: ìµœëŒ€ 10ê°œ

### Frontend
- **ë¹Œë“œ ì‹œê°„**: ì•½ 1.4ì´ˆ
- **ë²ˆë“¤ í¬ê¸°**: ~292KB (gzip: ~91KB)
- **í´ë§ ê°„ê²©**: 3ì´ˆ

---

## ğŸ“š ì°¸ì¡° ë¬¸ì„œ ìœ„ì¹˜

### í•„ìˆ˜ ë¬¸ì„œ
- **ì‹œì‘ ê°€ì´ë“œ**: `.docs/ğŸš€_ì‹œì‘í•˜ê¸°_í•„ë….md`
- **í™˜ê²½ ì„¤ì •**: `.docs/í™˜ê²½ì„¤ì •/01_í™˜ê²½ì„¤ì •_ê°€ì´ë“œ.md`
- **ë°°í¬ ê°€ì´ë“œ**: `.docs/í™˜ê²½ì„¤ì •/02_ë°°í¬_ê°€ì´ë“œ.md`
- **MCP ê°€ì´ë“œ**: `.docs/MCP/MCP_ë¹ ë¥¸ì°¸ì¡°.md`

### ê°œë°œ ì§€ì¹¨
- **í”„ë¡œì íŠ¸ ê°œìš”**: `.docs/ê°œë°œì§€ì¹¨/01_í”„ë¡œì íŠ¸_ê°œìš”.md`
- **ë§¤ë§¤ ì „ëµ**: `.docs/ê°œë°œì§€ì¹¨/02_ë§¤ë§¤_ì „ëµ.md`
- **ì‹ í˜¸ í¬ì°©**: `.docs/ê°œë°œì§€ì¹¨/03_ì‹ í˜¸_í¬ì°©.md`
- **ë°ì´í„° ìˆ˜ì§‘**: `.docs/ê°œë°œì§€ì¹¨/04_ë°ì´í„°_ìˆ˜ì§‘.md`
- **MASTER CONTROL**: `.docs/ê°œë°œì§€ì¹¨/05_MASTER_CONTROL.md`

### ë²„ì „ ê´€ë¦¬
- **CHANGELOG**: `CHANGELOG.md`
- **ì§„í–‰ì‚¬í•­**: `backup/ì§„í–‰ì‚¬í•­.md`

---

## ğŸ¯ ì¦‰ì‹œ ì‹œì‘í•˜ê¸°

### 1ë‹¨ê³„: ë¬¸ì„œ ì½ê¸°
```bash
cat .docs/ğŸš€_ì‹œì‘í•˜ê¸°_í•„ë….md
```

### 2ë‹¨ê³„: í™˜ê²½ í™•ì¸
```bash
# Python ê°€ìƒí™˜ê²½
source backend/venv/bin/activate

# DB ì—°ê²° í…ŒìŠ¤íŠ¸
mysql -h 114.108.180.228 -P 3306 -u blueeye -p mywork_01
```

### 3ë‹¨ê³„: ë¡œì»¬ ì‹¤í–‰
```bash
# Backend (ë³„ë„ í„°ë¯¸ë„)
cd backend
source venv/bin/activate
uvicorn main:app --reload --port 9100

# Frontend (ë³„ë„ í„°ë¯¸ë„)
cd frontend
npm run dev
```

### 4ë‹¨ê³„: í…ŒìŠ¤íŠ¸
- http://localhost:5173 ì—ì„œ í”„ë¡ íŠ¸ì—”ë“œ í™•ì¸
- http://localhost:9100/api/report ì—ì„œ API í…ŒìŠ¤íŠ¸

---

## âš ï¸ ì¤‘ìš” ì‚¬í•­

### ë³´ì•ˆ
1. **ë¹„ë°€ë²ˆí˜¸ ê´€ë¦¬**: ëª¨ë“  ë¹„ë°€ë²ˆí˜¸ëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬
2. **API í‚¤ ë³´í˜¸**: `.gitignore`ì— ì„¤ì • íŒŒì¼ í¬í•¨
3. **HTTPS ì‚¬ìš©**: í”„ë¡œë•ì…˜ì—ì„œëŠ” SSL ì¸ì¦ì„œ ì ìš©

### ë°±ì—…
```bash
# ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
mysqldump -h 114.108.180.228 -u blueeye -p mywork_01 > backup_$(date +%Y%m%d).sql

# ì„¤ì • íŒŒì¼ ë°±ì—…
cp -r .docs ~/backup/
cp CHANGELOG.md ~/backup/
```

### ëª¨ë‹ˆí„°ë§
```bash
# ì„œë²„ ìƒíƒœ í™•ì¸
sudo systemctl status cheongan-backend

# ë¡œê·¸ ì‹¤ì‹œê°„ í™•ì¸
journalctl -u cheongan-backend -f

# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
df -h
```

---

## ğŸ“ ê°œë°œ íŒ

### MCP í™œìš© ì˜ˆì‹œ
```
"signal_history í…Œì´ë¸”ì˜ ìµœê·¼ 100ê°œ ë ˆì½”ë“œë¥¼ ì¡°íšŒí•´ì¤˜"
"DashboardPage.jsxì—ì„œ fetchData í•¨ìˆ˜ë¥¼ ì°¾ì•„ì¤˜"
"SOXL ë§¤ë§¤ ì „ëµì„ ë‹¨ê³„ë³„ë¡œ ë¶„ì„í•´ì¤˜"
"ë°±ì—”ë“œ ì„œë²„ë¥¼ ì¬ì‹œì‘í•˜ê³  ë¡œê·¸ë¥¼ í™•ì¸í•´ì¤˜"
```

### ë””ë²„ê¹…
```python
# Backend ë””ë²„ê¹…
import logging
logging.basicConfig(level=logging.DEBUG)
logger = logging.getLogger(__name__)
logger.debug(f"Debug info: {data}")
```

```javascript
// Frontend ë””ë²„ê¹…
console.log('Data:', data);
console.table(holdings);
```

---

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2026-01-04 20:06  
**ì‘ì„±ì**: Antigravity AI Agent  
**ë²„ì „**: 1.0  

> ğŸ’¡ **ì´ ë¬¸ì„œëŠ” í”„ë¡œì íŠ¸ì˜ ëª¨ë“  í•µì‹¬ ì •ë³´ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤. ì‘ì—… ì „ ë°˜ë“œì‹œ ì½ì–´ì£¼ì„¸ìš”!**
